# Introduction #

The frameoutX program is used to converge raw coordinate trajectories generated by the MD dGROMOS engine into either CNF or PDB format. It uses a combination of methods to ensure that the structure of the molecules are sensible, solving issues related to periodicity which are cause by translation, rotation and/or unfolding of the molecules.

# Details #
Atoms of each molecule is gathered using a nearest images clustering algorithm, either with respect to the previous molecule or the center of geometry of multiple molecules, which can be defined in the input file.

# _`<jobs>`_ tag #
```
<job id="1"> 
```
A input file can have multiple `<job>` tags. When the program is executed, it will look for the job tag that contains the attribute `id` set to number you provided in the arguments.

## _`<topology>`_ tag ##
As the topology parser is not available yet, the user have to specified the start and end of the molecules here (atom 1 is the first atom listed in the coordinates). Additional, there is a distinction between different kind of molecules and the order in which they are processed.

### _`<atom_records_count>`_ tag ###
```
<atom_records_count>103690</atom_records_count> 
```
Tells the program how many lines it should expect (solutes with solvent).

### _`<solutes>`_ tag ###
Tells the program that these solute molecules should be gathered first using the more expensive clustering algorithm. Solute molecules defined in this block are additionally check for correct position in space with respect to proceeding solute molecules.

### _`<solutes_cog>`_ tag ###
Tells the program that these solutes should be gather with respected to the center of geometry of solutes defined in _`<solutes>`_. Molecules listed here are gathered second.

### _`<ions>`_ tag ###
Tells the program that these solutes should be gather with respected to the center of geometry of solutes defined in _`<solutes_cog>`_ and _`<solutes>`_. Molecules listed here are gathered third.

### _`<solvent>`_ tag ###
```
<solvent first_atom="6602" last_atom="103690" skip="false"> 
```
Tells the program:
  * where the first and last atom of the solvent molecules are located
  * whether solvent atoms should be written to output
Solvent is gathered last. The solvent atoms are expected to be in one contiguous block. Multiple blocks are not allowed. However, if required, assign the smallest block to _`<solute_cog>`_.

### _`<number_of_atoms>`_ tag ###
```
<number_of_atoms>3</number_of_atoms> 
```
Tells the program how many atoms are in each molecule.

### _`<dimension_search>`_ tag ###
```
<dimension_search>1</dimension_search> 
```
Tells the program how many nearest images it should scan in the attempt to find correct coordinates.

### _`<solute>`_ tag ###
```
<solute first_atom="1" last_atom="2631" skip="false" init_atom="1">
```
Tells the program:
  * where the first and last atom of the solvent molecules are located
  * whether solute atoms should be written to output
  * which atom in the current solute molecule is closest to the previous solute molecule

### _`<ion>`_ tag ###
```
<ion first_atom="5339" last_atom="6577" skip="false" init_atom="5339">
```
Tells the program:
  * where the first and last atom of the solvent molecules are located
  * whether ion atoms should be written to output

# _`<analysis>`_ tag #
Contains variable needed for the program to execute correctly.

### _`<frameout>`_ tag ###
```
<frameout gather="true" >
```
Contain variable for the frameoutX program. Contains and attribute that enable or disable gathering.

### _`<distance_cut_off>`_ tag ###
```
distance_cut_off>0.2</distance_cut_off>
```
The distance cut-off used by the clustering algorithm when reverse looping during execution. Value should be between 0 and 3, that is, no cut-off and longest bond in the force field.

### _`<cog_write>`_ tag ###
```
<cog_write>true</cog_write>
```
Write out the center of geometry without translational or rotational fit applied on it. Can be _true_ or _false_.

### _`<correction_translation>`_ tag ###
```
<correction_translation>true</correction_translation>
```
Enable or disable translational correction, center of geometry will be shifted to (0,0,0). Can be _true_ or _false_.

### _`<correction_rotation>`_ tag ###
```
<correction_rotation>true</correction_rotation>
```
Enable or disable rotational fit. First frame is used as reference for fitting. Translational correction is enabled automatically, center of geometry will be shifted to (0,0,0). Can be _true_ or _false_.

### _`<solvent_sphere>`_ tag ###
```
<solvent_sphere cut_off="0.5">true</solvent_sphere>
```
Write out an artificial spherical system water molecules at specified cut-off distance from largest distance found between all solute atoms. Can be _true_ or _false_.

### _`<write_skip>`_ tag ###
Contains a list of atoms that will not be written out. Use with caution. Molecular viewers cannot cope with this feature, that could be useful if a spherical system has to be cut out.

### _`<atom>`_ tag ###
```
<atom>12</atom>
```
Atom number of the atom to exclude.

# Example input file #
As can be seen below, the input file is in XML complaint format.
```
<?xml version="1.0" encoding="utf-8"?>
<me>
  <job id="1">
    <topology>
      <atom_records_count>103690</atom_records_count>
      <solvent first_atom="6602" last_atom="103690" skip="false">
        <number_of_atoms>3</number_of_atoms>
        <dimension_search>2</dimension_search>
      </solvent>
      <solutes_cog>
        <solute first_atom="5263" last_atom="5287" skip="false" init_atom="5263">
          <number_of_atoms>1</number_of_atoms>
          <dimension_search>1</dimension_search>
        </solute>
        <solute first_atom="5288" last_atom="5312" skip="false" init_atom="5288">
          <number_of_atoms>1</number_of_atoms>
          <dimension_search>1</dimension_search>
        </solute>
        <solute first_atom="5313" last_atom="5325" skip="false" init_atom="5313">
          <number_of_atoms>1</number_of_atoms>
          <dimension_search>1</dimension_search>
        </solute>
        <solute first_atom="5326" last_atom="5338" skip="false" init_atom="5326">
          <number_of_atoms>1</number_of_atoms>
          <dimension_search>1</dimension_search>
        </solute>
      </solutes_cog>
      <ions>
        <ion first_atom="6578" last_atom="6601" skip="false" init_atom="6578">
          <number_of_atoms>1</number_of_atoms>
          <dimension_search>1</dimension_search>
        </ion>
        <ion first_atom="5339" last_atom="6577" skip="false" init_atom="5339">
          <number_of_atoms>3</number_of_atoms>
          <dimension_search>1</dimension_search>
        </ion>
      </ions>
      <solutes>
        <solute first_atom="1" last_atom="2631" skip="false" init_atom="1">
          <dimension_search>1</dimension_search>
        </solute>
        <solute first_atom="2632" last_atom="5262" skip="false" init_atom="3699">
          <dimension_search>1</dimension_search>
        </solute>
      </solutes>
    </topology>
    <analysis>
     <frameout gather="true" >
      <distance_cut_off>0.2</distance_cut_off>
      <cog_write>true</cog_write>
      <correction_translation>true</correction_translation>
      <correction_rotation>true</correction_rotation>
      <solvent_sphere cut_off="0.5">true</solvent_sphere>
       <write_skip>
         <atom></atom>
       </write_skip>
     </frameout>
    </analysis>
    <variables>
      <frames_per_thread>4</frames_per_thread>
      <number_of_threads>8</number_of_threads>
      <number_of_threads_multiplier>1</number_of_threads_multiplier>
      <reference_file>ref2.cnf</reference_file>
    </variables>
    <input>
      <format>trc</format>
      <files>
        <file>md-bpam344-bpfh-10mm_1_mpi.trc.gz</file>
      </files>
    </input>
    <output>
      <filename_prefix>test</filename_prefix>
      <format>pdb</format>
      <frames_per_file>0</frames_per_file>
      <frame_interval>0</frame_interval>
      <time_interval>0</time_interval>
    </output>
  </job>
</me>
```